---
title: "nVidia ã®ã‚°ãƒ©ãƒœã§ Wayland ä½¿ã†"
emoji: "ğŸ§"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["linux", "archlinux", "wayland", "nvidia"]
published: true
---

# å‹•æ©Ÿ

1. XMonad ã ã¨ Steam ã®ã‚²ãƒ¼ãƒ ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒä¸å¯©ãªå‹•ãã‚’ã™ã‚‹ã“ã¨ãŒã‚ã‚‹
1. Gnome (Mutter) ã«ã—ãŸã‚‰ã€å¤§ä¸ˆå¤«ã ã‚ã†
1. ã›ã£ã‹ããªã®ã§ã€Wayland ä½¿ã£ã¦ã¿ã‚ˆã†


# ç’°å¢ƒ

- Intel CPU
- RTX 3060
- Arch Linux


# å•é¡Œ

Gnome ã«ã—ã¦ã‚‚ã€Wayland ã§ã¯ãªã x11 ã§å‹•ã„ã¦ã‚‹ã€‚

ç¢ºèªæ–¹æ³•ã¯ã€

```shell
$ echo $XDG_SESSION_TYPE
```


# ã‚„ã‚‹ã“ã¨

## GNOME ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒãƒãƒ¼ã‚¸ãƒ£ (Mutter) ã‚‚ä¸€ç·’ã«å…¥ã‚‹ã¿ãŸã„ã€‚

```
# pacman -S gdm gnome gnome-control-center xorg-xwayland
```

## Display Manager

`sddm` ã‚’ä½¿ã£ã¦ã„ãŸã®ã§ã€`gdm` ã«å¤‰æ›´ã™ã‚‹ã€‚

```
$ sudo systemctl enable gdm
$ sudo systemctl disable sddm
```

## udev

nVidia ã®ã‚°ãƒ©ãƒœã ã¨ã€å¼·åˆ¶çš„ã« x11 ã«ã™ã‚‹è¨­å®šãŒã‚ã‚‹ã‚‰ã—ã„ã®ã§ã€ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚
ã“ã‚Œã¯ã€null ãƒ‡ãƒã‚¤ã‚¹ã«ãƒªãƒ³ã‚¯ã—ã¦ã„ã‚‹ã ã‘ã ãŒã€çµæœçš„ã« `/usr/lib/udev/rules.d/61-gdm.rules` ã‚’ä¸Šæ›¸ãã—ã¦ãã‚Œã‚‹ã€‚

```
# ln -s /dev/null /etc/udev/rules.d/61-gdm.rules
```

## ã‚«ãƒ¼ãƒãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

â†‘ã§ã‚‚ãƒ€ãƒ¡ãªã‚‰ã€ `nvidia_drm.modeset=1` ã‚’åŠ ãˆã¦èµ·å‹•ã™ã‚‹ã€‚

æ°¸ç¶šåŒ–ã®ãŸã‚ã«ã€`/etc/default/grub` ã® `GRUB_CMDLINE_LINUX_DEFAULT` ã‚’â†“ã®ã‚ˆã†ã«ã™ã‚‹ã€‚

```
GRUB_CMDLINE_LINUX_DEFAULT="loglevel=3 quiet nvidia_drm.modeset=1"
```

ã‚ã¨ã¯ã€`grub.cfg` ã®ç”Ÿæˆã€‚

```
# grub-mkconfig -o /boot/grub/grub.cfg
# mkinitcpio -p linux
```


## ãŠã‚ã‚Š

å†èµ·å‹•ã—ãŸã‚‰ã€å¤§ä¸ˆå¤«ã€‚ãŸã¶ã‚“ã€‚
